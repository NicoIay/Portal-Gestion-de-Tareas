<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Crear Tarea</title>
  <link rel="stylesheet" href="./css/agregar-tarea.css">
</head>
<body>
  <div class="formulario-container">
    <form action="#" method="POST" id="formulario">
      <h2>Crear Tarea</h2>

      <div class="campo">
        <label for="nombre">Nombre de la Tarea:</label>
        <input type="text" id="nombre" name="nombre" placeholder="Ej: Práctica de dinámica">
      </div>

      <div class="campo">
        <label for="materia">Materia:</label>
        <select id="materia" name="materia">
          <option value="">Selecciona una materia</option>
          <option value="Fisica 1">Física 1</option>
          <option value="PSP">PSP</option>
          <option value="Paradigmas">Paradigmas de Programación</option>
        </select>
      </div>

      <div class="campo">
        <label for="descripcion">Descripción:</label>
        <textarea id="descripcion" name="descripcion" rows="3" placeholder="Agrega detalles..."></textarea>
      </div>

      <div class="campo">
        <label for="fecha">Fecha de entrega:</label>
        <input type="date" id="fecha" name="fecha">
      </div>

      <div class="campo">
        <label for="estado">Estado:</label>
        <select id="estado" name="estado">
          <option value="pendiente">Pendiente</option>
          <option value="completada">Completada</option>
        </select>
      </div>

      <button type="submit" class="btn-crear">Crear Tarea</button>
      <button type="button" class="btn-volver" onclick="volverPagina()">⬅ Volver</button>
    </form>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => { // **ES RECOMENDADO USAR DOMContentLoaded**
        const $formulario = document.querySelector("#formulario");
        const $nombre = document.querySelector("#nombre");
        const $descripcion = document.querySelector("#descripcion");
        const $fecha = document.querySelector("#fecha");
        const $materia = document.querySelector("#materia"); // **CORREGIDO: Faltaban comillas**
        

        if ($formulario) { // Verificar que el formulario existe
            $formulario.onsubmit = evento => {
                evento.preventDefault();

                const nombre = $nombre.value.trim();
                const descripcion = $descripcion.value.trim();
                const fecha = $fecha.value;
                const materia = $materia.value;
                const estado = $estado.value; // Obtener el valor del estado

                const MIN_LENGTH_DESCRIPCION = 10; // Mejor nombre para la constante

                // Validaciones
                if (nombre === "") {
                    alert("El nombre de la tarea no puede estar vacío.");
                    return;
                }

                if (nombre.length <= 5) {
                    alert("El nombre de la tarea es muy corto (mínimo 6 caracteres).");
                    return;
                }

                if (materia === "") { // Validar que se seleccionó una materia
                    alert("El campo de materia no puede estar vacío.");
                    return;
                }
                

                if (descripcion.length < MIN_LENGTH_DESCRIPCION) {
                    alert(`La descripción es muy corta. Debe contener al menos ${MIN_LENGTH_DESCRIPCION} caracteres.`);
                    return;
                }

              
                // Si todas las validaciones PASAN, entonces procesa los datos:
                const nuevaTarea = {
                    id: Date.now(),
                    nombre: nombre,
                    materia: materia, // Usar la variable materia ya obtenida
                    descripcion: descripcion,
                    fechaEntrega: fecha,
                    estado: estado // Usar la variable estado ya obtenida
                };

                console.log("Nueva Tarea:", nuevaTarea);
                alert("Tarea creada exitosamente!"); // Mensaje de éxito

                $formulario.reset(); // **CORREGIDO: Resetear el formulario**
                
            };
        } 
    });
  </script>
</body>
</html>
